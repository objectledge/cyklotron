#genericScreenHeader("IMPORTED RESOURCES")

#result_inline_message("results.aggregation")

#macro(status_name $status)
#if($status == 0)
aktualny##
#elseif($status == 1)
zmodyfikowany##
#else
skasowany##
#end
#end

$table.getColumn('sourceSite').set('label', 'from site')
$table.getColumn('source').set('label', 'source resource')
$table.getColumn('target').set('label', 'target resource')
$table.getColumn('state').set('label', 'state')
$table.getColumn('action').set('label', 'action')

#set($columnOrder = ['sourceSite','source','target','state','action'])
#set($tableLink = $link.set('tableId',$table.getId()))

<table class="genericScreen" width="100%" cellpadding="0" cellspacing="0">
  <tr>
    <th colspan="$columnOrder.size()">Imported resources</th>
  </tr>
  #if($table.getPageRowCount() == 0)
  <tr>
    <td colspan="$columnOrder.size()">None</td>
  </tr>
  #else
  <tr>
   #tableView_header($table $tableLink $columnOrder)
  </tr>

   #foreach($row in $table.rows)
    #set($odd = $velocityCount % 2)
  <tr class="row$odd">
    <td>$row.object.sourceSite.name</td>
     #if($row.object.state != 2)
    <td>#resource_view_link($row.object.source)</td>
     #else
    <td>&nbsp;</td>
     #end
    <td>#resource_view_link($row.object.destination)</td>
    <td>#status_name($row.object.state)</td>
    <td>
    	#set($definition = $cms_tool.getClassDefinition($row.object.destination))
    	#if($row.object.state == 1 && $definition.getAggregationUpdateAction())
         <a href="$link.action($definition.getAggregationUpdateAction()).set('src_id',$row.object.getSourceId()).set('dst_id',$row.object.destination.id)">
         update</a>
        #else
        -
        #end
    </td>
  </tr>
   #end
  #end
</table>
#genericScreenTrailer()